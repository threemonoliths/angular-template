<div class="ui-g ui-fluid">
    <div class="ui-g-12">
        <form [formGroup]="transferForm" novalidate>
        <div class="card card-w-title">

            <p-panel [header]="title" [toggleable]="true">

            <div class="ui-g form-group">

                <div class="ui-g-12 ui-md-4">
                    <span class="md-inputfield">
                        <input id="billno" type="text" pInputText formControlName="billno" class="ng-dirty ng-invalid" [readonly]="!editable">
                        <label>调拨单号</label>

                        
                        <div class="ui-message ui-messages-error ui-corner-all" 
                        *ngIf="(transferForm.controls['billno'].touched || submitted) && 
                               !transferForm.controls['billno'].valid &&
                               transferForm.controls['billno'].errors?.required ">
                            *调拨单号必填
                        </div>
                        <div class="ui-message ui-messages-error ui-corner-all" 
                        *ngIf="transferForm.controls['billno'].errors?.pattern">
                             *只能使用字母、数字
                        </div>
                        <div class="ui-message ui-messages-error ui-corner-all" 
                        *ngIf="transferForm.controls['billno'].errors?.minlength || transferForm.controls['billno'].errors?.maxlength">
                            *调拨单号长度为4～30个字符
                        </div>
                       
                    </span>
                </div>

                <div class="ui-g-12 ui-md-4">
                    <span class="md-inputfield">
                        <p-calendar id="calendar" formControlName="date" placeholder="日期" dateFormat="yy.mm.dd" dataType="string" [locale]="en" [disabled]="!editable"></p-calendar>
                        <div class="ui-message ui-messages-error ui-corner-all" 
                        *ngIf="(transferForm.controls['date'].touched || submitted) && 
                               transferForm.controls['date'].errors?.required ">
                            *日期必填
                        </div>
                    </span>
                </div>
                <div class="ui-g-12 ui-md-4">
                    <span class="md-inputfield">
                        <input type="text" pInputText formControlName="stockplace" [readonly]="!editable">
                        <label>移出罐（车）号</label>
                        <div class="ui-message ui-messages-error ui-corner-all" 
                        *ngIf="(transferForm.controls['stockplace'].touched || submitted) && 
                               transferForm.controls['stockplace'].errors?.required ">
                            *移出罐（车）号必填
                        </div>
                    </span>
                </div>
                
                <div class="ui-g-12 ui-md-4">
                    <span class="md-inputfield">
                        <input type="text" pInputText formControlName="dispatcher" [readonly]="!editable">
                        <label>调度</label>
                        <div class="ui-message ui-messages-error ui-corner-all" 
                        *ngIf="(transferForm.controls['dispatcher'].touched || submitted) && 
                               transferForm.controls['dispatcher'].errors?.required ">
                            *调度必填
                        </div>
                      
                    </span>
                </div>
                <div class="ui-g-12 ui-md-4">
                    <span class="md-inputfield">
                        <input type="text" pInputText formControlName="stockman" [readonly]="!editable">
                        <label>保管员</label>
                         <div class="ui-message ui-messages-error ui-corner-all" 
                        *ngIf="(transferForm.controls['stockman'].touched || submitted) && 
                               transferForm.controls['stockman'].errors?.required ">
                            *保管员必填
                        </div> 
                    </span>
                </div>
                <div class="ui-g-12 ui-md-4">
                    <span class="md-inputfield">
                        <input type="text" pInputText formControlName="accountingclerk" [readonly]="!editable">
                        <label>核算员</label>
                         <div class="ui-message ui-messages-error ui-corner-all" 
                        *ngIf="(transferForm.controls['accountingclerk'].touched || submitted) && 
                               transferForm.controls['accountingclerk'].errors?.required ">
                            *核算员必填
                        </div> 
                    </span>
                </div>
                 <div class="ui-g-12 ui-md-4">
                    <span class="md-inputfield">
                        <input type="text" pInputText formControlName="entryperson" [readonly]="!editable">
                        <label>录入人</label>
                         <div class="ui-message ui-messages-error ui-corner-all" 
                        *ngIf="(transferForm.controls['entryperson'].touched || submitted) && 
                               transferForm.controls['entryperson'].errors?.required ">
                            *录入人必填
                        </div> 
                    </span>
                </div>
                 <div class="ui-g-12 ui-md-4">
                    <span class="md-inputfield">
                        <input type="text" pInputText formControlName="auditperson" [readonly]="!editable">
                        <label>审核人</label>
                         <div class="ui-message ui-messages-error ui-corner-all" 
                        *ngIf="(transferForm.controls['auditperson'].touched || submitted) && 
                               transferForm.controls['auditperson'].errors?.required ">
                            *审核人必填
                        </div> 
                    </span>
                </div>
                 <div class="ui-g-12 ui-md-4">
                    <span class="md-inputfield">
                        <input type="text" pInputText formControlName="state" [readonly]="!editable">
                        <label>状态</label>
                         <div class="ui-message ui-messages-error ui-corner-all" 
                        *ngIf="(transferForm.controls['state'].touched || submitted) && 
                               transferForm.controls['state'].errors?.required ">
                            *状态必填
                        </div> 
                    </span>
                </div>
                 <div class="ui-g-12 ui-md-4">
                    <span class="md-inputfield">
                        <input type="text" pInputText formControlName="auditdate" [readonly]="!editable">
                        <label>审核时间</label>
                         <div class="ui-message ui-messages-error ui-corner-all" 
                        *ngIf="(transferForm.controls['auditdate'].touched || submitted) && 
                               transferForm.controls['auditdate'].errors?.required ">
                            *审核时间必填
                        </div> 
                    </span>
                </div>

                 <div class="ui-g-12 ui-md-12">
                        <span class="md-inputfield">
                            
                            <div class="ui-message ui-messages-error ui-corner-all" 
                            *ngIf="submitted && 
                                   !detailsChecked ">
                                *请确保下面的明细表中每条明细记录的“泵码起数”、“泵码止数”、“数量”字段为有效数字
                            </div>
                        </span>
                    </div> 
               
                <div class="ui-g-12 ui-md-12">
                    <div>
                        <p-toolbar>
                            <div class="ui-toolbar-group-left">
                                <button pButton type="button" icon="ui-icon-add" class="green-btn" (click)="addTransferDetail()"></button>
                                <button pButton type="button" icon="ui-icon-delete" class="red-btn" (click)="deleteTransferDetail()"></button>
                            </div>
                        </p-toolbar>
                        <p-dataTable [value]="details" [editable]="yesorno" dataKey="id" [(selection)]="selectedDetail" #dt>
                            <p-column [style]="{'width':'38px'}" selectionMode="single"></p-column>
                            <p-column field="id" header="id" hidden="true" ></p-column>
                            <p-column field="billno" header="调拨单号" [editable]="true"></p-column>
                            <p-column field="stockpalce" header="移入罐（车）号" [editable]="true"></p-column>
                            <p-column field="unit" header="计量单位" [editable]="true"></p-column>
                            <p-column field="startdegree" header="泵码起数" [editable]="true"></p-column>
                            <p-column field="enddegree" header="泵码止数" [editable]="true"></p-column>
                            <p-column field="quantity" header="数量" [editable]="true"></p-column>
                            <p-column field="confirmation" header="确认人" [editable]="true"></p-column>
                        </p-dataTable>
   
                    </div>
                </div>
            </div>
        
            </p-panel>
           <p-toolbar>
                <div class="ui-toolbar-group-left">
                    <button pButton type="button" icon="ui-icon-save" class="green-btn" (click)="onSubmit()"></button>
                    <button pButton type="reset" icon="ui-icon-autorenew" class="orange-btn"></button>
                     <button pButton type="button" icon="ui-icon-check" class="pink-btn" (click)="onAudited()"></button>
                </div>
            </p-toolbar>
        </div>
        </form>
    </div>
</div>
